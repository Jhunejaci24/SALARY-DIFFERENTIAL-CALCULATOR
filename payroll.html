<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Payroll - Salary Differential on Promotion</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      font-size: 12px;
    }
    .container {
      max-width: 900px;
      margin: auto;
    }
    h3 {
      text-align: center;
      margin: 5px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }
    table td, table th {
      border: 1px solid #000;
      padding: 6px;
      text-align: center;
    }
    th {
      background-color: #f0f0f0;
      font-weight: bold;
    }
    [contenteditable] {
      outline: none;
    }
    .signature-name {
      font-weight: bold;
      text-decoration: underline;
      margin-top: 40px;
    }
    .info-text {
      margin-bottom: 15px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h3>PAYROLL</h3>
    <h3><span contenteditable="true">SALARY DIFFERENTIAL ON PROMOTION</span></h3>

    <!-- Plain text info section -->
  <div class="info-text">
  <span style="display: inline-block; width: 650px;">
    Entity Name: ____________________________
  </span>
  Payroll No.: ______________________</span><br>

  <span style="display: inline-block; width: 650px;">
    Fund Cluster: _________________________
  </span>
  Sheet ____ of____ Sheets<br>

  We acknowledge receipt of cash shown opposite our name as full compensation for services rendered for the period covered.
</div>

    <!-- Main Payroll Table -->
    <table>
      <thead>
        <tr>
          <th rowspan="2">Serial No.</th>
          <th rowspan="2" style="width: 300px;">Name</th>
          <th rowspan="2">Position</th>
          <th rowspan="2">Account Number</th>
          <th rowspan="2">Inclusive Dates</th>
          <th colspan="3">COMPENSATIONS</th>
          <th colspan="6">DEDUCTIONS</th>
          <th rowspan="2">Net Amount Due</th>
          <th rowspan="2">Signature of Recipient</th>
        </tr>
        <tr>
          <th>-----</th>
          <th>-----</th>
          <th>Gross Amount Earned</th>
          <th>GSIS PS (9%)</th>
          <th>PHIC (2.5%)</th>
          <th>Withholding Tax</th>
          <th>GS (12%)</th>
          <th>GS PHIC (2.5%)</th>
          <th>Total Deductions</th>
        </tr>
      </thead>
      <tbody>
        <!-- Entry Row -->
        <tr>
          <td>1</td>
          <td>Jhune Jaci</td>
          <td>AO2</td>
          <td></td>
          <td span contenteditable="true">2/5/2025 to 12/31/2025</span></td>
          <td></td>
          <td></td>
          <td>32,454.55</td>
          <td>2,931.43</td>
          <td>811.36</td>
          <td>3,245.45</td>
          <td>3,908.57</td>
          <td>811.36</td>
          <td>6,988.25</td><td>25,466.30</td><td>&nbsp;</td>
        </tr>

       <!-- 10 Empty Rows with partitions -->
<tr>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>


        <!-- Grand Total -->
        <tr>
          <td></td>
          <td><strong>Grand Total</strong></td>
          <td></td>
          <td></td>
          <td></td>
          <td>_____</td>
          <td>_____</td>
          <td>32,454.55</td>
          <td>2,931.43</td>
          <td>811.36</td>
          <td>3,245.45</td>
          <td>3,908.57</td>
          <td>811.36</td>
          <td>6,988.25</td><td>25,466.30</td><td>&nbsp;</td>
        </tr>

        <!-- Certification Rows -->
        <tr>
          <td colspan="8" style="padding: 0; vertical-align: top;">
  <div style="font-weight: bold; text-align: left;">
    A. CERTIFIED: Services duly rendered as stated.
  </div>
  <div contenteditable="true" class="signature-name"><span contenteditable="true">SUSAN MARIE P. BARTOLOME, PhD</span></div>
  <em>Signature over Printed Name of Authorized Official</em><br>
  <div contenteditable="true">Date:<u><span contenteditable="true"> ____________________</span></div>
</td>


          <td colspan="8" style="padding: 0; vertical-align: top;">
  <div style="font-weight: bold; text-align: left;">
    C. APPROVED FOR PAYMENT:
  </div>
  <div style="text-align: center; margin-top: 4px;">
    <span id="amount-in-words">Twenty Five Thousand Four Hundred Sixty Six &amp; 30/100 Pesos Only</span><br>
    (<strong>₱<span id="net-amount">25,466.30</span></strong>)
  </div>
  <div contenteditable="true" class="signature-name"><span contenteditable="true">RACHEL R. LLANA, PhD CESO V</span></div>
  <em>Signature over Printed Name<br>Head of Agency/Authorized Representative</em><br>
  <div contenteditable="true">Date:<span contenteditable="true"> ____________________</span></div>
</td>

<script>
function numberToWords(amount) {
    const th = ["", "Thousand", "Million", "Billion", "Trillion"];
    const dg = ["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"];
    const tn = ["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
    const tw = ["Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
    
    amount = parseFloat(amount).toFixed(2);
    let [num, dec] = amount.split(".");
    let n = parseInt(num);
    if (n === 0) return "Zero Pesos Only";

    let str = "";
    let i = 0;
    while(n > 0){
        let temp = n % 1000;
        if(temp != 0){
            let hundreds = Math.floor(temp/100);
            let tens_units = temp % 100;
            let words = "";
            if(hundreds) words += dg[hundreds]+" Hundred ";
            if(tens_units){
                if(tens_units < 10) words += dg[tens_units]+" ";
                else if(tens_units < 20) words += tn[tens_units-10]+" ";
                else words += tw[Math.floor(tens_units/10)-2]+" "+dg[tens_units%10]+" ";
            }
            str = words + th[i] + " " + str;
        }
        n = Math.floor(n/1000);
        i++;
    }
    return str.trim() + " Pesos " + (dec=="00"?"Only":("and "+dec+"/100"));
}

// Set the amount in words dynamically
document.getElementById("amount-in-words").innerText = numberToWords(document.getElementById("net-amount").innerText);
</script>

        </tr>
        <tr>
     <td colspan="8" style="padding: 0; vertical-align: top;">
  <div style="font-weight: bold; text-align: left;">
    B. CERTIFIED: Supporting documents complete and proper; and cash available in the amount of <strong>₱25,466.30</strong>
  </div>
  <div contenteditable="true" class="signature-name"><span contenteditable="true">GERALDINE R. NONATO, CPA</span></div>
  <em>Signature over Printed Name<br>Head of Accounting Division/Unit</em><br>
  <div contenteditable="true">Date:<span contenteditable="true"> ____________________</span></div>
</td>


          <td colspan="4" style="padding: 0; vertical-align: top;">
  <div style="font-weight: bold; text-align: left;">D.</div>
  <div contenteditable="true" class="signature-name"><span contenteditable="true">JHOANNA LIZA L. RAMIREZ</span></div>
  <em>Signature over Printed Name<br>Disbursing Officer</em><br>
  <div contenteditable="true">Date:<span contenteditable="true"> ____________________</span></div>
</td>

 <td colspan="4" style="padding: 0; vertical-align: top;">
  <div style="font-weight: bold; text-align: left;">E.</div>
  <div contenteditable="true" style="margin-left: 15px; margin-top: 10px;">ORS/BURS No.:<span contenteditable="true"> _______________</span></div>
  <div contenteditable="true" style="margin-left: 15px; margin-top: 5px;">Date: <span contenteditable="true">____________________</span></div>
  <div contenteditable="true" style="margin-left: 15px; margin-top: 5px;">JEV No.: <span contenteditable="true">_____________________</span></div>
</td>

        </tr>
      </tbody>
    </table>
  </div>
<script>
function numberToWords(amount) {
    const th = ["", "Thousand", "Million", "Billion", "Trillion"];
    const dg = ["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"];
    const tn = ["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
    const tw = ["Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
    
    amount = parseFloat(amount).toFixed(2);
    let [num, dec] = amount.split(".");
    let n = parseInt(num);
    if (n === 0) return "Zero Pesos Only";

    let str = "";
    let i = 0;
    while(n > 0){
        let temp = n % 1000;
        if(temp != 0){
            let hundreds = Math.floor(temp/100);
            let tens_units = temp % 100;
            let words = "";
            if(hundreds) words += dg[hundreds]+" Hundred ";
            if(tens_units){
                if(tens_units < 10) words += dg[tens_units]+" ";
                else if(tens_units < 20) words += tn[tens_units-10]+" ";
                else words += tw[Math.floor(tens_units/10)-2]+" "+dg[tens_units%10]+" ";
            }
            str = words + th[i] + " " + str;
        }
        n = Math.floor(n/1000);
        i++;
    }
    return str.trim() + " Pesos " + (dec=="00"?"Only":("and "+dec+"/100"));
}

window.addEventListener("load", function() {
  if (localStorage.getItem("dv_ready") === "true") {
    // --- 1. Populate first row ---
    const firstRow = document.querySelector("tbody tr");
    if (!firstRow) return;
    const tds = firstRow.querySelectorAll("td");

    tds[1].innerText = localStorage.getItem("dv_name") || "";
    tds[2].innerText = localStorage.getItem("dv_position") || "";
    tds[3].innerText = localStorage.getItem("dv_account") || "";

    // --- 2. Read all numeric values from localStorage ---
    const totalPS = parseFloat(localStorage.getItem("dv_total_ps")) || 0;
    const gsisPS = parseFloat(localStorage.getItem("dv_ps9")) || 0;               
    const philhealthPS = parseFloat(localStorage.getItem("dv_philhealth_ps")) || 0; 
    const withholding = parseFloat(localStorage.getItem("dv_withholding")) || 0;
    const gsisGS = parseFloat(localStorage.getItem("dv_gsis")) || 0;               
    const philhealthGS = parseFloat(localStorage.getItem("dv_philhealth_gs")) || 0; 

    // --- 3. Compute Total Deductions and Net Amount ---
    const totalDeduct = gsisPS + philhealthPS + withholding;
    const netAmount = totalPS - totalDeduct;

    // --- 4. Populate first row columns ---
    tds[7].innerText = totalPS.toLocaleString('en-US',{minimumFractionDigits:2});   // Gross Amount
    tds[8].innerText = gsisPS.toLocaleString('en-US',{minimumFractionDigits:2});    // GSIS PS
    tds[9].innerText = philhealthPS.toLocaleString('en-US',{minimumFractionDigits:2}); // PHIC PS
    tds[10].innerText = withholding.toLocaleString('en-US',{minimumFractionDigits:2}); // Withholding
    tds[11].innerText = gsisGS.toLocaleString('en-US',{minimumFractionDigits:2});   // GSIS GS
    tds[12].innerText = philhealthGS.toLocaleString('en-US',{minimumFractionDigits:2}); // PHIC GS
    tds[13].innerText = totalDeduct.toLocaleString('en-US',{minimumFractionDigits:2}); // Total Deductions
    tds[14].innerText = netAmount.toLocaleString('en-US',{minimumFractionDigits:2});   // Net Amount

    // --- 5. Update Net Amount element & Amount in words ---
    const netAmtEl = document.getElementById("net-amount");
    if (netAmtEl) netAmtEl.innerText = netAmount.toLocaleString('en-US',{minimumFractionDigits:2});

    const amountWordsEl = document.getElementById("amount-in-words");
    if (amountWordsEl) amountWordsEl.innerText = numberToWords(netAmount);

    // --- 6. Copy first row to Grand Total row ---
    const grandRow = Array.from(document.querySelectorAll("tbody tr")).find(row => row.querySelector("strong"));
    if (grandRow) {
      const grandTds = grandRow.querySelectorAll("td");
      [7,8,9,10,11,12,13,14].forEach(colIndex => {
        grandTds[colIndex].innerText = tds[colIndex].innerText;
      });
    }

    // --- 7. Update B. CERTIFIED amount ---
    const certifiedTd = Array.from(document.querySelectorAll("td[colspan='8']")).find(td => 
      td.innerText.includes("Supporting documents complete and proper")
    );
    if (certifiedTd) {
      const strongEl = certifiedTd.querySelector("strong");
      if (strongEl) strongEl.innerText = "₱" + netAmount.toLocaleString('en-US',{minimumFractionDigits:2});
    }
  }
});
</script>


</body>
</html>
